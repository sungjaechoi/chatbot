# 요청 분석: 20260203-vercel-ai-gateway-크레딧-표시

## 작업 개요

| 항목 | 내용 |
|------|------|
| **작업 ID** | 20260203-vercel-ai-gateway-크레딧-표시 |
| **분석 일시** | 2026-02-03 현재 |
| **요청 요약** | Vercel AI Gateway의 Credits API를 활용하여 메인화면과 챗봇 화면에 크레딧 잔액을 표시하고, AI 응답에 토큰 사용량과 비용을 표시하는 기능 구현 |

## 요구사항

### 기능 요구사항

1. 메인 첫화면 'PDF 기반 챗봇' 헤더에 남은 크레딧 금액 표시
2. 챗봇 화면 헤더에 남은 크레딧 금액 표시
3. AI 응답 결과의 시간 옆에 사용 토큰과 사용 금액 표시
4. Credits API (GET /v1/credits) 연동으로 잔액 조회
5. Generation Lookup API로 개별 요청 비용 조회

### 비기능 요구사항

- BYOK 사용 시 AI Gateway 요금이 원래 비용의 3%만 부과되는 점 고려

## 작업 범위

| 영역 | 작업 내용 |
|------|-----------|
| **Backend** | Credits API 엔드포인트 생성, Chat API 응답에 토큰/비용 정보 추가, 타입 정의 |
| **Frontend** | CollectionListView/ChatView 헤더에 크레딧 표시, MessageListView AI 응답에 토큰/비용 표시 |

## 완료 조건

- [ ] /api/credits 엔드포인트가 balance와 total_used 반환
- [ ] /api/chat 응답에 prompt_tokens, completion_tokens, total_cost 포함
- [ ] 메인 페이지와 챗봇 페이지 헤더에 크레딧 잔액이 표시됨
- [ ] AI 응답 메시지에 타임스탬프와 함께 토큰/비용 정보 표시

## 실행 계획

| 순서 | 에이전트 | 작업 내용 |
|------|----------|-----------|
| 1 | backend-developer | Credits API 엔드포인트 생성 및 Chat API 응답 확장 |
| 2 | frontend-developer | 크레딧 잔액 및 토큰/비용 정보 UI 구현 |
| 3 | reviewer | 코드 품질 검증 및 요구사항 충족 확인 |

## 리스크 및 주의사항

- Vercel AI Gateway API의 gateway.getCredits() 함수 사용 가능 여부 확인 필요
- Generation ID 획득 방법이 streamText 결과에서 제공되는지 확인 필요
- API 호출 실패 시 적절한 폴백 처리 필요

---
*생성: Orchestrator | 일시: 2026-02-03 현재*
