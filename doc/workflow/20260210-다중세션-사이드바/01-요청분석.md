# 요청 분석: 20260210-다중세션-사이드바

## 작업 개요

| 항목 | 내용 |
|------|------|
| **작업 ID** | 20260210-다중세션-사이드바 |
| **분석 일시** | 2026-02-10 14:00 |
| **요청 요약** | PDF 1개당 채팅 세션 N개 지원으로 전환하고, 사이드바 UI를 도입하여 PDF 목록/세션 목록 관리, 세션 rename/삭제, LLM 기반 세션 제목 자동생성 등의 기능을 구현하는 대규모 리팩토링 작업. |

## 요구사항

### 기능 요구사항

1. PDF 1:N 채팅 세션 지원 (기존 1:1에서 변경)
2. 새 세션 열기: 이전 세션 제목 LLM 자동생성(10자 내외) 후 새 세션 생성
3. 사이드바: PDF 목록 + 현재 PDF의 세션 목록 관리
4. 세션 rename(연필): 인라인 편집, Enter/blur 저장, Esc 취소, max 20자
5. 세션 삭제(휴지통): confirm 후 세션+메시지 삭제, 최신 세션 이동 또는 새 세션 생성
6. PDF 클릭 시 가장 최신 세션으로 진입 (없으면 새 세션 생성)
7. 사이드바 하단: 사용자 정보 + 설정(테마/로그아웃)
8. 사이드바 상단: 새 문서 등록 아이콘
9. 사이드바 토글: 데스크탑 collapse + 모바일 overlay drawer

### 비기능 요구사항

- 기존 디자인 시스템(Editorial Luxury 테마, CSS 변수) 일관성 유지
- TypeScript 타입 안전성 확보
- LLM 제목 생성 시 토큰 비용 최소화

## 작업 범위

| 영역 | 작업 내용 |
|------|-----------|
| **Backend** | DB 스키마 마이그레이션(title, last_message_at 추가, UNIQUE 제거), 세션 CRUD API 5개, 메시지 조회 API, LLM 제목 생성 API, 기존 /api/chat 수정 |
| **Frontend** | ChatLayout(사이드바+채팅뷰) 도입, ChatSidebar 컴포넌트, chatStore 확장(sessionList, currentSessionId, sidebarOpen), 세션 전환/생성/삭제 UX, pdfStore 연동 |

## 완료 조건

- [ ] PDF 1개에 여러 채팅 세션 생성 가능
- [ ] 새 세션 생성 시 이전 세션에 LLM 제목이 자동 부여됨
- [ ] 사이드바에서 PDF 목록과 세션 목록이 표시됨
- [ ] 세션 rename/삭제가 정상 동작함
- [ ] PDF 진입 시 최신 세션이 자동 로드됨
- [ ] 사이드바 토글이 데스크탑/모바일 모두 동작함
- [ ] 빌드 에러 없음 (npm run build 통과)

## 실행 계획

| 순서 | 에이전트 | 작업 내용 |
|------|----------|-----------|
| 1 | backend-developer | DB 스키마 마이그레이션 + 세션/메시지 CRUD API + LLM 제목 생성 API 구현 |
| 2 | frontend-developer | 사이드바 UI + chatStore 확장 + 세션 전환/생성/삭제 UX 구현 |
| 3 | reviewer | 전체 코드 품질, API 정합성, UI/UX 완성도 검증 |

## 리스크 및 주의사항

- DB 스키마 변경(UNIQUE 제거)이 기존 데이터와 호환되는지 확인 필요
- 기존 /api/chat/history 의존 코드 마이그레이션 누락 가능성
- LLM 제목 생성 API 호출 시 비용 증가 가능성
- 사이드바 도입으로 레이아웃 전면 변경 - 기존 UI 회귀 가능성
- 세션 전환 시 race condition (비동기 상태 관리)

---
*생성: Orchestrator | 일시: 2026-02-10 14:00*
